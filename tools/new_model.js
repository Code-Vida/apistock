const { MongoClient } = require("mongodb");
const { v4: uuidv4 } = require("uuid");

function getHexColors(colorString) {
  if (!colorString) {
    return {
      colorSlug: "sem_cor",
      colorLabel: "Sem Cor",
      hex1: "#CCCCCC",
      hex2: null,
    };
  }

  const slug = colorString.trim().toLowerCase().replace(/\s+/g, "_");

  const colorMap = {
    
    amarelo: { hex1: "#FFFF00", hex2: null },
    amendoa: { hex1: "#FFEBCD", hex2: null },
    ametista: { hex1: "#9966CC", hex2: null },
    areia: { hex1: "#C2B280", hex2: null },
    argila: { hex1: "#CC7F66", hex2: null },
    aveia: { hex1: "#F0EAD6", hex2: null },
    avela: { hex1: "#A26C3B", hex2: null },
    avocado: { hex1: "#568203", hex2: null },
    azaleia: { hex1: "#FBCCE7", hex2: null },
    azul: { hex1: "#0000FF", hex2: null },
    baunilha: { hex1: "#F3E5AB", hex2: null },
    bege: { hex1: "#F5F5DC", hex2: null },
    bisque: { hex1: "#FFE4C4", hex2: null },
    blush: { hex1: "#DE5D83", hex2: null },
    bordo: { hex1: "#800000", hex2: null },
    borgonha: { hex1: "#800020", hex2: null },
    branco: { hex1: "#FFFFFF", hex2: null },
    bronze: { hex1: "#CD7F32", hex2: null },
    cafe: { hex1: "#6F4E37", hex2: null },
    caju: { hex1: "#C68B59", hex2: null },
    camel: { hex1: "#C19A6B", hex2: null },
    camelia: { hex1: "#C67280", hex2: null },
    camelo: { hex1: "#C19A6B", hex2: null },
    canela: { hex1: "#D2691E", hex2: null },
    caramelo: { hex1: "#D2691E", hex2: null },
    castanho: { hex1: "#954535", hex2: null },
    castor: { hex1: "#BEABA0", hex2: null },
    celeste: { hex1: "#B2FFFF", hex2: null },
    champanhe: { hex1: "#F7E7CE", hex2: null },
    chantily: { hex1: "#F8F0E3", hex2: null },
    chino: { hex1: "#E3CD80", hex2: null },
    chocolate: { hex1: "#7B3F00", hex2: null },
    chumbo: { hex1: "#6B7569", hex2: null },
    ciano: { hex1: "#00FFFF", hex2: null },
    cidreira: { hex1: "#C8D97D", hex2: null },
    cinza: { hex1: "#808080", hex2: null },
    cobre: { hex1: "#B87333", hex2: null },
    colorido: { hex1: "#808000", hex2: null },
    coral: { hex1: "#FF7F50", hex2: null },
    cream: { hex1: "#FFFDD0", hex2: null },
    crema: { hex1: "#FFFDD0", hex2: null },
    creme: { hex1: "#FFFDD0", hex2: null },
    denim: { hex1: "#1560BD", hex2: null },
    dourado: { hex1: "#FFD700", hex2: null },
    ferrari: { hex1: "#FF2800", hex2: null },
    flamingo: { hex1: "#FC8983", hex2: null },
    framboesa: { hex1: "#E20062", hex2: null },
    frozen: { hex1: "#C3F8FF", hex2: null },
    fucsia: { hex1: "#FF00FF", hex2: null },
    garoa: { hex1: "#B0C4DE", hex2: null },
    gelo: { hex1: "#F0F8FF", hex2: null },
    glitter: { hex1: "#C0C0C0", hex2: null },
    goiabada: { hex1: "#D24F4F", hex2: null },
    gold: { hex1: "#FFD700", hex2: null },
    grafite: { hex1: "#36454F", hex2: null },
    granito: { hex1: "#676767", hex2: null },
    granola: { hex1: "#D6BF94", hex2: null },
    havana: { hex1: "#330000", hex2: null },
    hortencia: { hex1: "#008B8B", hex2: null },
    jasmin: { hex1: "#F8DE7E", hex2: null },
    jeans: { hex1: "#5D8AA8", hex2: null },
    kiwi: { hex1: "#8EE53E", hex2: null },
    laranja: { hex1: "#FFA500", hex2: null },
    laco: { hex1: "#F5F5DC", hex2: null },
    leao: { hex1: "#FFD700", hex2: null },
    lemon: { hex1: "#FFF700", hex2: null },
    lilaa: { hex1: "#C8A2C8", hex2: null },
    lilas: { hex1: "#C8A2C8", hex2: null },
    lima: { hex1: "#00FF00", hex2: null },
    linhaca: { hex1: "#FAF0E6", hex2: null },
    listrado: { hex1: "#000000", hex2: null },
    macadamia: { hex1: "#F8F0E3", hex2: null },
    machiato: { hex1: "#964B00", hex2: null },
    magenta: { hex1: "#FF00FF", hex2: null },
    malagueta: { hex1: "#CC0000", hex2: null },
    malibu: { hex1: "#50BFE6", hex2: null },
    mandarina: { hex1: "#FF8C00", hex2: null },
    marfim: { hex1: "#FFFFF0", hex2: null },
    marine: { hex1: "#000080", hex2: null },
    marinho: { hex1: "#000080", hex2: null },
    marrom: { hex1: "#A52A2A", hex2: null },
    mascavo: { hex1: "#8B4513", hex2: null },
    mel: { hex1: "#FFC30B", hex2: null },
    menta: { hex1: "#99FF99", hex2: null },
    mescla: { hex1: "#C0C0C0", hex2: null },
    moleton: { hex1: "#A9A9A9", hex2: null },
    natural: { hex1: "#F5DEB3", hex2: null },
    nautico: { hex1: "#000080", hex2: null },
    nescau: { hex1: "#4B2925", hex2: null },
    noz: { hex1: "#80664B", hex2: null },
    nozes: { hex1: "#80664B", hex2: null },
    nude: { hex1: "#E3BC9A", hex2: null },
    off: { hex1: "#F5F5DC", hex2: null },
    onca: { hex1: "#A52A2A", hex2: null },
    orquidea: { hex1: "#DA70D6", hex2: null },
    ouro: { hex1: "#FFD700", hex2: null },
    pele: { hex1: "#FCD6B5", hex2: null },
    perola: { hex1: "#FDF5E6", hex2: null },
    pessego: { hex1: "#FFE5B4", hex2: null },
    petroleo: { hex1: "#005F6B", hex2: null },
    pewter: { hex1: "#899499", hex2: null },
    pink: { hex1: "#FFC0CB", hex2: null },
    pitaya: { hex1: "#FF005A", hex2: null },
    praia: { hex1: "#ADD8E6", hex2: null },
    prata: { hex1: "#C0C0C0", hex2: null },
    preto: { hex1: "#000000", hex2: null },
    rato: { hex1: "#9E9E9E", hex2: null },
    rosa: { hex1: "#FFC0CB", hex2: null },
    rose: { hex1: "#F88379", hex2: null },
    rouge: { hex1: "#A91B0D", hex2: null },
    roxo: { hex1: "#800080", hex2: null },
    safari: { hex1: "#A8A087", hex2: null },
    safira: { hex1: "#0F52BA", hex2: null },
    salinas: { hex1: "#9F8170", hex2: null },
    salmao: { hex1: "#FA8072", hex2: null },
    sereia: { hex1: "#40E0D0", hex2: null },
    siciliano: { hex1: "#FDEB7B", hex2: null },
    solar: { hex1: "#FFD700", hex2: null },
    tan: { hex1: "#D2B48C", hex2: null },
    telha: { hex1: "#A64639", hex2: null },
    terracota: { hex1: "#E2725B", hex2: null },
    terroso: { hex1: "#8B4513", hex2: null },
    transparente: { hex1: "#FFFFFF", hex2: null },
    tule: { hex1: "#F5F5DC", hex2: null },
    tulipa: { hex1: "#FF8FAD", hex2: null },
    uva: { hex1: "#6F2DA8", hex2: null },
    verde: { hex1: "#008000", hex2: null },
    vermelho: { hex1: "#FF0000", hex2: null },
    vinho: { hex1: "#800000", hex2: null },
    violeta: { hex1: "#EE82EE", hex2: null },

    
    aranha_preto: { hex1: "#000000", hex2: null }, 
    aurora_b: { hex1: "#6BE5BF", hex2: null },
    azul_a: { hex1: "#0000FF", hex2: null },
    azul_amarelo: { hex1: "#0000FF", hex2: "#FFFF00" },
    azul_azul: { hex1: "#0000FF", hex2: "#0000FF" },
    azul_branco: { hex1: "#0000FF", hex2: "#FFFFFF" },
    azul_cinza: { hex1: "#0000FF", hex2: "#808080" },
    azul_claro: { hex1: "#ADD8E6", hex2: null },
    azul_claro_mickey: { hex1: "#ADD8E6", hex2: null }, 
    azul_dalmata: { hex1: "#0000FF", hex2: null }, 
    azul_escuro: { hex1: "#00008B", hex2: null },
    azul_g: { hex1: "#0000FF", hex2: null },
    azul_l: { hex1: "#0000FF", hex2: null },
    azul_laranja: { hex1: "#0000FF", hex2: "#FFA500" },
    azul_lilas: { hex1: "#0000FF", hex2: "#C8A2C8" },
    azul_medio: { hex1: "#4169E1", hex2: null },
    azul_prata: { hex1: "#0000FF", hex2: "#C0C0C0" },
    azul_rebook: { hex1: "#0000FF", hex2: null }, 
    azul_rosa: { hex1: "#0000FF", hex2: "#FFC0CB" },
    azul_verde: { hex1: "#0000FF", hex2: "#008000" },
    azul_vermelho: { hex1: "#0000FF", hex2: "#FF0000" },
    b_bege: { hex1: "#F5F5DC", hex2: null },
    b_bordo: { hex1: "#800000", hex2: null },
    b_celeste: { hex1: "#B2FFFF", hex2: null },
    b_cinza: { hex1: "#808080", hex2: null },
    b_esmeralda: { hex1: "#50C878", hex2: null },
    b_hidra: { hex1: "#00BFFF", hex2: null },
    b_holografico: { hex1: "#C0C0C0", hex2: null },
    b_nude: { hex1: "#E3BC9A", hex2: null },
    b_onix: { hex1: "#36454F", hex2: null },
    b_ouro: { hex1: "#FFD700", hex2: null },
    b_prata: { hex1: "#C0C0C0", hex2: null },
    b_preto: { hex1: "#000000", hex2: null },
    b_rosado: { hex1: "#F4C2C2", hex2: null },
    baunulha: { hex1: "#F3E5AB", hex2: null },
    bco: { hex1: "#FFFFFF", hex2: null },
    bco_bco: { hex1: "#FFFFFF", hex2: "#FFFFFF" },
    bco_pto: { hex1: "#FFFFFF", hex2: "#000000" },
    bco_pto_ver: { hex1: "#FFFFFF", hex2: "#000000" },
    bege_b: { hex1: "#F5F5DC", hex2: null },
    bege_onca: { hex1: "#F5F5DC", hex2: "#A52A2A" },
    bege_ostra: { hex1: "#ECE8DD", hex2: null },
    bege_p: { hex1: "#F5F5DC", hex2: null },
    bege_preto: { hex1: "#F5F5DC", hex2: "#000000" },
    branco_collor: { hex1: "#FFFFFF", hex2: null },
    branco_laco: { hex1: "#FFFFFF", hex2: null },
    branco_preto: { hex1: "#FFFFFF", hex2: "#000000" },
    branco_azul: { hex1: "#FFFFFF", hex2: "#0000FF" },
    branco_branco: { hex1: "#FFFFFF", hex2: "#FFFFFF" },
    branco_cobre: { hex1: "#FFFFFF", hex2: "#B87333" },
    branco_glitter: { hex1: "#FFFFFF", hex2: "#C0C0C0" },
    branco_novo: { hex1: "#FFFFFF", hex2: null },
    branco_nude: { hex1: "#FFFFFF", hex2: "#E3BC9A" },
    branco_onca: { hex1: "#FFFFFF", hex2: "#A52A2A" },
    branco_onix: { hex1: "#FFFFFF", hex2: "#36454F" },
    branco_ouro: { hex1: "#FFFFFF", hex2: "#FFD700" },
    branco_p: { hex1: "#FFFFFF", hex2: null },
    branco_pink: { hex1: "#FFFFFF", hex2: "#FFC0CB" },
    branco_prata: { hex1: "#FFFFFF", hex2: "#C0C0C0" },
    branco_r: { hex1: "#FFFFFF", hex2: null },
    branco_rosa: { hex1: "#FFFFFF", hex2: "#FFC0CB" },
    branco_rose: { hex1: "#FFFFFF", hex2: "#F88379" },
    cachorrinha: { hex1: "#8B4513", hex2: null }, 
    capitao_america: { hex1: "#0000FF", hex2: null }, 
    capitao_azul: { hex1: "#0000FF", hex2: null },
    capitao_royal: { hex1: "#4169E1", hex2: null },
    carro: { hex1: "#C0C0C0", hex2: null }, 
    chumbo_rosa: { hex1: "#6B7569", hex2: "#FFC0CB" },
    cinza_pink: { hex1: "#808080", hex2: "#FFC0CB" },
    cinza_azul: { hex1: "#808080", hex2: "#0000FF" },
    cinza_bege: { hex1: "#808080", hex2: "#F5F5DC" },
    cinza_c: { hex1: "#808080", hex2: null },
    cinza_dourado: { hex1: "#808080", hex2: "#FFD700" },
    cinza_marrom: { hex1: "#808080", hex2: "#A52A2A" },
    cinza_preto: { hex1: "#808080", hex2: "#000000" },
    cinza_pretov: { hex1: "#808080", hex2: "#000000" },
    cinza_pto: { hex1: "#808080", hex2: "#000000" },
    cinza_verde: { hex1: "#808080", hex2: "#008000" },
    creme_branco: { hex1: "#FFFDD0", hex2: "#FFFFFF" },
    creme_cristal: { hex1: "#FFFDD0", hex2: null },
    creme_rosa: { hex1: "#FFFDD0", hex2: "#FFC0CB" },
    flor_transparente: { hex1: "#FFFFFF", hex2: null },
    frozen_pink: { hex1: "#C3F8FF", hex2: "#FFC0CB" },
    g_branco: { hex1: "#FFFFFF", hex2: null },
    g_branco_b: { hex1: "#FFFFFF", hex2: "#000000" },
    g_preto: { hex1: "#000000", hex2: null },
    g_rosa: { hex1: "#FFC0CB", hex2: null },
    g_rose: { hex1: "#F88379", hex2: null },
    gatinha: { hex1: "#FFC0CB", hex2: null }, 
    glitter_branco: { hex1: "#C0C0C0", hex2: "#FFFFFF" },
    glitter_nude: { hex1: "#C0C0C0", hex2: "#E3BC9A" },
    grafite_l: { hex1: "#36454F", hex2: null },
    grafite_n: { hex1: "#36454F", hex2: null },
    grafite_p: { hex1: "#36454F", hex2: null },
    grafite_pink: { hex1: "#36454F", hex2: "#FFC0CB" },
    grafite_pto: { hex1: "#36454F", hex2: "#000000" },
    grafite_rosa: { hex1: "#36454F", hex2: "#FFC0CB" },
    grafite_salmao: { hex1: "#36454F", hex2: "#FA8072" },
    grafite_verde: { hex1: "#36454F", hex2: "#008000" },
    grafite_vermelho: { hex1: "#36454F", hex2: "#FF0000" },
    homem_aranha: { hex1: "#0000FF", hex2: null }, 
    homem_aranha_preto: { hex1: "#0000FF", hex2: "#000000" },
    homem_de_ferro: { hex1: "#FF0000", hex2: null }, 
    homem_de_ferro_preto: { hex1: "#FF0000", hex2: "#000000" },
    homem_ferro_preto: { hex1: "#FF0000", hex2: "#000000" },
    justica: { hex1: "#808080", hex2: null }, 
    l_branco: { hex1: "#FFFFFF", hex2: null },
    l_branco_b: { hex1: "#FFFFFF", hex2: "#000000" },
    lilas_rosa: { hex1: "#C8A2C8", hex2: "#FFC0CB" },
    lilas_azul: { hex1: "#C8A2C8", hex2: "#0000FF" },
    lilas_g: { hex1: "#C8A2C8", hex2: null },
    lilas_lavanda: { hex1: "#C8A2C8", hex2: "#E6E6FA" },
    lilas_lilas: { hex1: "#C8A2C8", hex2: "#C8A2C8" },
    lilas_uva: { hex1: "#C8A2C8", hex2: "#6F2DA8" },
    lilas_verde: { hex1: "#C8A2C8", hex2: "#008000" },
    lilo_rosa: { hex1: "#FFC0CB", hex2: null },
    lilo_pink: { hex1: "#FFC0CB", hex2: null },
    lilo_royal: { hex1: "#4169E1", hex2: null },
    lol: { hex1: "#FFC0CB", hex2: null }, 
    lol_preto: { hex1: "#FFC0CB", hex2: "#000000" },
    mario: { hex1: "#FF0000", hex2: null }, 
    mario_royal: { hex1: "#FF0000", hex2: "#4169E1" },
    marinhi: { hex1: "#000080", hex2: null },
    marinho_v: { hex1: "#000080", hex2: null },
    marinho_b: { hex1: "#000080", hex2: null },
    marinho_g: { hex1: "#000080", hex2: null },
    marinho_laranja: { hex1: "#000080", hex2: "#FFA500" },
    marinho_limao: { hex1: "#000080", hex2: "#00FF00" },
    marinho_p: { hex1: "#000080", hex2: null },
    marinho_pink: { hex1: "#000080", hex2: "#FFC0CB" },
    marinho_pino: { hex1: "#000080", hex2: null },
    marinho_taupe: { hex1: "#000080", hex2: "#483C32" },
    marinho_uva: { hex1: "#000080", hex2: "#6F2DA8" },
    marinho_verde: { hex1: "#000080", hex2: "#008000" },
    marinho_vermelho: { hex1: "#000080", hex2: "#FF0000" },
    marrom_bege: { hex1: "#A52A2A", hex2: "#F5F5DC" },
    marrom_escuro: { hex1: "#654321", hex2: null },
    marrom_m: { hex1: "#A52A2A", hex2: null },
    marrom_marrom: { hex1: "#A52A2A", hex2: "#A52A2A" },
    marrom_verde: { hex1: "#A52A2A", hex2: "#008000" },
    mickey: { hex1: "#FF0000", hex2: null }, 
    mickey_preto: { hex1: "#FF0000", hex2: "#000000" },
    minnie: { hex1: "#FF0000", hex2: null }, 
    minnie_rosa: { hex1: "#FF0000", hex2: "#FFC0CB" },
    minnie_pink: { hex1: "#FF0000", hex2: "#FFC0CB" },
    minnie_preto: { hex1: "#FF0000", hex2: "#000000" },
    minnie_vermelho: { hex1: "#FF0000", hex2: "#FF0000" },
    mulher_maravilha: { hex1: "#FF0000", hex2: null }, 
    multi_bege: { hex1: "#F5F5DC", hex2: null },
    multi_camel: { hex1: "#C19A6B", hex2: null },
    multi_nude: { hex1: "#E3BC9A", hex2: null },
    multi_preto: { hex1: "#000000", hex2: null },
    multi_rosa: { hex1: "#FFC0CB", hex2: null },
    multipreto: { hex1: "#000000", hex2: null },
    napa_preto: { hex1: "#000000", hex2: null },
    nude_b: { hex1: "#E3BC9A", hex2: null },
    nude_branco: { hex1: "#E3BC9A", hex2: "#FFFFFF" },
    nude_claro: { hex1: "#F5DDC6", hex2: null },
    nude_glitter: { hex1: "#E3BC9A", hex2: "#C0C0C0" },
    nude_light: { hex1: "#F5DDC6", hex2: null },
    nude_ligth: { hex1: "#F5DDC6", hex2: null },
    nude_ouro: { hex1: "#E3BC9A", hex2: "#FFD700" },
    nudr: { hex1: "#E3BC9A", hex2: null },
    off_areia: { hex1: "#F5F5DC", hex2: "#C2B280" },
    off_pink: { hex1: "#F5F5DC", hex2: "#FFC0CB" },
    off_preto: { hex1: "#F5F5DC", hex2: "#000000" },
    off_pto: { hex1: "#F5F5DC", hex2: "#000000" },
    off_taupe: { hex1: "#F5F5DC", hex2: "#483C32" },
    ofr: { hex1: "#F5F5DC", hex2: null },
    oft: { hex1: "#F5F5DC", hex2: null },
    ouro_ouro: { hex1: "#FFD700", hex2: "#FFD700" },
    ouro_r: { hex1: "#FFD700", hex2: null },
    ouro_rosado: { hex1: "#B76E79", hex2: null },
    patrulha_laranja: { hex1: "#FFA500", hex2: null },
    patrulha_azul: { hex1: "#0000FF", hex2: null },
    patrulha_canina: { hex1: "#FFA500", hex2: null }, 
    patrulha_pink: { hex1: "#FFC0CB", hex2: null },
    patrulha_preto: { hex1: "#000000", hex2: null },
    patrulha_rosa: { hex1: "#FFC0CB", hex2: null },
    pelica_preto: { hex1: "#000000", hex2: null },
    prero: { hex1: "#000000", hex2: null },
    preto_pink: { hex1: "#000000", hex2: "#FFC0CB" },
    preto_preto: { hex1: "#000000", hex2: "#000000" },
    preto_amarelo: { hex1: "#000000", hex2: "#FFFF00" },
    preto_azul: { hex1: "#000000", hex2: "#0000FF" },
    preto_b: { hex1: "#000000", hex2: null },
    preto_bege: { hex1: "#000000", hex2: "#F5F5DC" },
    preto_blush: { hex1: "#000000", hex2: "#DE5D83" },
    preto_branco: { hex1: "#000000", hex2: "#FFFFFF" },
    preto_c: { hex1: "#000000", hex2: null },
    preto_camurca: { hex1: "#000000", hex2: null },
    preto_ciano: { hex1: "#000000", hex2: "#00FFFF" },
    preto_cinza: { hex1: "#000000", hex2: "#808080" },
    preto_dourado: { hex1: "#000000", hex2: "#FFD700" },
    preto_escolar: { hex1: "#000000", hex2: null },
    preto_g: { hex1: "#000000", hex2: null },
    preto_glitter: { hex1: "#000000", hex2: "#C0C0C0" },
    preto_grafite: { hex1: "#000000", hex2: "#36454F" },
    preto_jasmim: { hex1: "#000000", hex2: "#F8DE7E" },
    preto_jasmin: { hex1: "#000000", hex2: "#F8DE7E" },
    preto_laranja: { hex1: "#000000", hex2: "#FFA500" },
    preto_limao: { hex1: "#000000", hex2: "#00FF00" },
    preto_liso: { hex1: "#000000", hex2: null },
    preto_lurex: { hex1: "#000000", hex2: null },
    preto_m: { hex1: "#000000", hex2: null },
    preto_niquel: { hex1: "#000000", hex2: "#727472" },
    preto_nobuck: { hex1: "#000000", hex2: null },
    preto_novo: { hex1: "#000000", hex2: null },
    preto_onca: { hex1: "#000000", hex2: "#A52A2A" },
    preto_ostra: { hex1: "#000000", hex2: "#ECE8DD" },
    preto_ouro: { hex1: "#000000", hex2: "#FFD700" },
    preto_p: { hex1: "#000000", hex2: null },
    preto_pelica: { hex1: "#000000", hex2: null },
    preto_prata: { hex1: "#000000", hex2: "#C0C0C0" },
    preto_rose: { hex1: "#000000", hex2: "#F88379" },
    preto_royal: { hex1: "#000000", hex2: "#4169E1" },
    preto_tar: { hex1: "#000000", hex2: null },
    preto_tart: { hex1: "#000000", hex2: null },
    preto_v: { hex1: "#000000", hex2: null },
    preto_verde: { hex1: "#000000", hex2: "#008000" },
    preto_verm: { hex1: "#000000", hex2: "#FF0000" },
    preto_vermelho: { hex1: "#000000", hex2: "#FF0000" },
    preto_verniz: { hex1: "#000000", hex2: null },
    preto_vidro: { hex1: "#000000", hex2: null },
    pretp: { hex1: "#000000", hex2: null },
    princesa_azul: { hex1: "#ADD8E6", hex2: null }, 
    pto_azul: { hex1: "#000000", hex2: "#0000FF" },
    pto_bco: { hex1: "#000000", hex2: "#FFFFFF" },
    pto_castor: { hex1: "#000000", hex2: "#BEABA0" },
    pto_g: { hex1: "#000000", hex2: null },
    pto_grafite: { hex1: "#000000", hex2: "#36454F" },
    pto_ouro: { hex1: "#000000", hex2: "#FFD700" },
    pto_pink: { hex1: "#000000", hex2: "#FFC0CB" },
    pto_pink_bco: { hex1: "#000000", hex2: "#FFC0CB" },
    pto_pink_pto: { hex1: "#000000", hex2: "#FFC0CB" },
    pto_pto: { hex1: "#000000", hex2: "#000000" },
    risa: { hex1: "#FFC0CB", hex2: null },
    roda_cobre: { hex1: "#B87333", hex2: null },
    roda_g: { hex1: "#808080", hex2: null },
    rosa_doce: { hex1: "#FFC0CB", hex2: null },
    rosa_rosa: { hex1: "#FFC0CB", hex2: "#FFC0CB" },
    rosa_amarelo: { hex1: "#FFC0CB", hex2: "#FFFF00" },
    rosa_azul: { hex1: "#FFC0CB", hex2: "#0000FF" },
    rosa_branco: { hex1: "#FFC0CB", hex2: "#FFFFFF" },
    rosa_cereja: { hex1: "#FFC0CB", hex2: "#DE3163" },
    rosa_chiclete: { hex1: "#FF69B4", hex2: null },
    rosa_choque: { hex1: "#FC0FC0", hex2: null },
    rosa_claro: { hex1: "#FFB6C1", hex2: null },
    rosa_cobre: { hex1: "#FFC0CB", hex2: "#B87333" },
    rosa_d: { hex1: "#FFC0CB", hex2: null },
    rosa_doce_claro: { hex1: "#FFB6C1", hex2: null },
    rosa_doce_medio: { hex1: "#FFC0CB", hex2: null },
    rosa_escuro: { hex1: "#E75480", hex2: null },
    rosa_fluor: { hex1: "#FF00FF", hex2: null },
    rosa_flúor: { hex1: "#FF00FF", hex2: null },
    rosa_g: { hex1: "#FFC0CB", hex2: null },
    rosa_g_e_claro: { hex1: "#FFC0CB", hex2: "#FFB6C1" },
    rosa_g_e_medio: { hex1: "#FFC0CB", hex2: "#FFC0CB" },
    rosa_glitter: { hex1: "#FFC0CB", hex2: "#C0C0C0" },
    rosa_laranja: { hex1: "#FFC0CB", hex2: "#FFA500" },
    rosa_leitoso: { hex1: "#FDF5E6", hex2: null },
    rosa_lilaa: { hex1: "#FFC0CB", hex2: "#C8A2C8" },
    rosa_lilas: { hex1: "#FFC0CB", hex2: "#C8A2C8" },
    rosa_marrom: { hex1: "#FFC0CB", hex2: "#A52A2A" },
    rosa_medio: { hex1: "#FFC0CB", hex2: null },
    rosa_metal: { hex1: "#FFC0CB", hex2: "#C0C0C0" },
    rosa_neon: { hex1: "#FF6EC7", hex2: null },
    rosa_nude: { hex1: "#FFC0CB", hex2: "#E3BC9A" },
    rosa_perolado: { hex1: "#FDF5E6", hex2: null },
    rosa_pi: { hex1: "#FFC0CB", hex2: null },
    rosa_pink: { hex1: "#FFC0CB", hex2: "#FFC0CB" },
    rosa_pitaya: { hex1: "#FFC0CB", hex2: "#FF005A" },
    rosa_preto: { hex1: "#FFC0CB", hex2: "#000000" },
    rosa_t: { hex1: "#FFC0CB", hex2: null },
    rosa_transparente: { hex1: "#FFC0CB", hex2: "#FFFFFF" },
    rosa_v: { hex1: "#FFC0CB", hex2: null },
    rosa_verde: { hex1: "#FFC0CB", hex2: "#008000" },
    rosa_vermelho: { hex1: "#FFC0CB", hex2: "#FF0000" },
    royal_verde: { hex1: "#4169E1", hex2: "#008000" },
    s_branco: { hex1: "#FFFFFF", hex2: null },
    s_azul: { hex1: "#0000FF", hex2: null },
    s_branco_b: { hex1: "#FFFFFF", hex2: "#000000" },
    s_rosa: { hex1: "#FFC0CB", hex2: null },
    sereia_lilas: { hex1: "#40E0D0", hex2: "#C8A2C8" },
    stitch: { hex1: "#ADD8E6", hex2: null }, 
    stitch_preto: { hex1: "#ADD8E6", hex2: "#000000" },
    stitch_preto_rosa: { hex1: "#ADD8E6", hex2: "#000000" },
    t_dourado: { hex1: "#FFD700", hex2: null },
    tranca_aurora_b: { hex1: "#6BE5BF", hex2: null },
    tranca_dourado: { hex1: "#FFD700", hex2: null },
    tranca_preto: { hex1: "#000000", hex2: null },
    unicornio: { hex1: "#F0EAD6", hex2: null },
    verde_a: { hex1: "#008000", hex2: null },
    verde_citrico: { hex1: "#A8D400", hex2: null },
    verde_laranja: { hex1: "#008000", hex2: "#FFA500" },
    verde_limco: { hex1: "#008000", hex2: null },
    verde_m: { hex1: "#008000", hex2: null },
    verde_mate: { hex1: "#9ACD32", hex2: null },
    verde_medio: { hex1: "#66CDAA", hex2: null },
    verde_pera: { hex1: "#D1E231", hex2: null },
    verde_preto: { hex1: "#008000", hex2: "#000000" },
    verde_pto: { hex1: "#008000", hex2: "#000000" },
    verde_rosa: { hex1: "#008000", hex2: "#FFC0CB" },
    verde_telha: { hex1: "#008000", hex2: "#A64639" },
    verde_turmalina: { hex1: "#40E0D0", hex2: null },
    verde_turquesa: { hex1: "#40E0D0", hex2: null },
    verde_verde: { hex1: "#008000", hex2: "#008000" },
    veree: { hex1: "#008000", hex2: null },
    verniz_preto: { hex1: "#000000", hex2: null },
    vidro: { hex1: "#FFFFFF", hex2: null },
    violeta_claro: { hex1: "#D8BFD8", hex2: null }
  };

  const hex = colorMap[slug] || { hex1: "#CCCCCC", hex2: null };

  return {
    colorSlug: slug,
    colorLabel: colorString,
    hex1: hex.hex1,
    hex2: hex.hex2,
  };
}

async function transformProducts() {
  const client = await MongoClient.connect("mongodb+srv://stockshoes:57IQdr2jRXYwYv5Q@stock.6zd9q1k.mongodb.net/?retryWrites=true&w=majority");
  const db = client.db("apistock");
  const oldCollection = db.collection("products");
  const newCollection = db.collection("products_new");

  const products = await oldCollection.find({}).toArray();

  const grouped = {};

  products.forEach((p) => {
    const brand = p.brand?.trim() || "sem_marca";
    const model = p.model?.trim() || "sem_modelo";
    const slug = `${brand}_${model}`.toLowerCase().replace(/\s+/g, "_");
    const storeId = 'bfa87926-d4c4-45b4-b43a-64adeec7d975'

    if (!grouped[slug]) {
      grouped[slug] = {
        _id: uuidv4(),
        slug,
        brand,
        model,
        storeId,
        value: p.value ?? null,
        purchaseValue: p.purchaseValue ?? null,
        createdAt: p.createdAt || new Date(),
        updatedAt: p.updatedAt || new Date(),
        variants: [],

      };
    }

    const group = grouped[slug];

    if (group.value === null && p.value != null) group.value = p.value;
    if (group.purchaseValue === null && p.purchaseValue != null)
      group.purchaseValue = p.purchaseValue;

    const hexColors = getHexColors(p.color);
    let variant = group.variants.find(
      (v) => v.colorSlug === hexColors.colorSlug
    );

    if (!variant) {
      variant = {
        colorSlug: hexColors.colorSlug,
        colorLabel: hexColors.colorLabel,
        hex1: hexColors.hex1,
        hex2: hexColors.hex2,
        items: [],
      };
      group.variants.push(variant);
    }

    
    const originalAmount = p.amount ?? 0;
    const sales = p.sales ?? 0;
    const available = Math.max(originalAmount - sales, 0);

    variant.items.push({
      number: p.number,
      amount: available,
      barCode: p.barCode,
      purchaseDate: p.purchaseDate,
      
    });
  });

  await newCollection.deleteMany({});
  const result = await newCollection.insertMany(Object.values(grouped));
  console.log("✅ Migração concluída:", result.insertedCount);

  await client.close();
}

transformProducts().catch((err) => {
  console.error("❌ Erro na migração:", err);
});